import { useState } from "react";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";

const groupMembers = [
  { name: "謝孝光", group: "喜乐" },
  { name: "王瑋", group: "喜乐" },
  { name: "王輔仁", group: "喜乐" },
  { name: "鍾秀蘭", group: "喜乐" },
  { name: "王健", group: "喜乐" },
  // 可根据需要继续添加成员数据
];

const uniqueGroups = [...new Set(groupMembers.map(m => m.group))];
const uniqueNames = groupMembers.map(m => m.name);

export default function AttendanceApp() {
  const [day, setDay] = useState("friday");
  const [group, setGroup] = useState("");
  const [name, setName] = useState("");
  const [records, setRecords] = useState({ friday: {}, sunday: {} });

  const addAttendance = () => {
    if (!group || !name) return;
    setRecords(prev => {
      const dayRecords = { ...prev[day] };
      if (!dayRecords[group]) dayRecords[group] = [];
      if (!dayRecords[group].includes(name)) dayRecords[group].push(name);
      return { ...prev, [day]: dayRecords };
    });
    setName("");
  };

  const switchDay = () => {
    setDay(prev => (prev === "friday" ? "sunday" : "friday"));
  };

  return (
    <div className="p-4 space-y-4">
      <div className="flex items-center space-x-2">
        <Button onClick={switchDay}>Switch to {day === "friday" ? "Sunday" : "Friday"}</Button>
        <span className="font-bold text-lg">Current Day: {day}</span>
      </div>

      <div className="space-y-2">
        <Input placeholder="Small Group Name" value={group} onChange={e => setGroup(e.target.value)} list="group-list" />
        <datalist id="group-list">
          {uniqueGroups.map((g, i) => (
            <option key={i} value={g} />
          ))}
        </datalist>

        <Input placeholder="Person's Name" value={name} onChange={e => setName(e.target.value)} list="name-list" />
        <datalist id="name-list">
          {uniqueNames.map((n, i) => (
            <option key={i} value={n} />
          ))}
        </datalist>

        <Button onClick={addAttendance}>Add Attendance</Button>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
        {Object.entries(records[day]).map(([groupName, attendees]) => (
          <Card key={groupName}>
            <CardContent className="p-4">
              <h2 className="text-xl font-semibold mb-2">Group: {groupName}</h2>
              <ul className="list-disc pl-5">
                {attendees.map((person, index) => (
                  <li key={index}>{person}</li>
                ))}
              </ul>
            </CardContent>
          </Card>
        ))}
      </div>
    </div>
  );
}
